---
title: 时间序列算法
date: 2017-09-02 17:07:50
tags: [算法,时间序列]
categories: 数字信号处理
copyright: yitakabe
---
# 1、时间序列预处理
<!--more-->
&emsp;&emsp;得到一个观测序列之后，要分析检验序列的随机性和平稳性。两个重要的检验称为序列的预处理。对于不同类型的序列需要采用不同的分析方法。

 1. 对于纯随机序列，又称白噪声序列，序列各个观测值之间没有任何关系，序列是完全无序的随机波动，则可以不用对序列继续分析。因为白噪声序列是没有任何信息可以提取的**平稳序列**。
 2. 对于平稳非白噪声序列，它的均值和方差是常数。目前已经有一套非常成熟的平稳序列的建模方法。通常是建议一个线性模型来拟合序列的发展。**ARMA**是最常用的平稳序列拟合模型。
 3. 对于非平稳序列，由于序列本身的均值和方差不稳定，处理方法一般是==将其转为平稳序列==，然后采用平稳序列的模型进行分析。对于非平稳序列，经过差分之后具有平稳性则称差分平稳序列，对于差分平稳序列可以使用ARMA模型对其进行分析。

## 1.1 平稳性检验
&emsp;&emsp;平稳性检验主要有两种方法：基于时序图和自相关图做出判断的方法，该方法简单方便，应用广泛，但是具有主观性。另一种方法是构造检验统计量进行验证，该方法最常用的方法是**单位根检测**。

 ### 1.1.1  时序图检验
&emsp;&emsp;平稳序列的时序图表现出始终在一个常数附近波动，波动范围有界。如果时序图有明显的趋势性或者周期性通常是非平稳序列。
 ### 1.1.2  自相关图检验
&emsp;&emsp;平稳序列具有短周期相关性，这性质表明平稳序列通常只有近期的序列值对当前值有明显的影响，随着延迟时间加长，自相关系数会衰减到0，并在0附近随机波动。而对于非平稳序列，自相关系数会衰减缓慢。
通过Matlab进行仿真：
``` stylus
fs=500;
t=1/500:1/500:1;
f=5;
r=randn(1,fs)*0.2;
y=sin(2*pi*t*f);
ycorr=xcorr(y,y);
rcorr=xcorr(r,r);
subplot(211);plot(t,y);title('非平稳序列时序图')
subplot(212);plot(ycorr);title('非平稳序列自相关图')
figure
subplot(211);plot(t,r);title('平稳序列时序图')
subplot(212);plot(rcorr);title('平稳序列时序图')
```
![非平稳序列时序图与自相关图](.\非平稳序列时序图与自相关图.jpg)

![平稳序列时序图与自相关图](.\平稳序列时序图与自相关图.jpg )
### 1.1.3 单位根检测
&emsp;&emsp;对序列是否具有单位根进行检测，如果存在单位根，则是非平稳序列，反之，是平稳序列。单位根检测有很多种方法。此处主要介绍：**DF检测(Dicky-Fuller Test)**和**ADF检测**。
## 1.2 纯随机性检测
&emsp;&emsp;纯随机性检验也称为白噪声检验，一般用构造的统计量来检验序列的纯随机性，常用的统计量有Q统计量和LB统计量。
&emsp;&emsp;序列值之间的变异是绝对的，但是相关性是偶然的，则可以做如下假设：
 &emsp;&emsp;- 原假设：延迟期数不大于$m$期的序列值是相互独立的。
 &emsp;&emsp;- 备用假设：延时期数不大于$m$期的序列值是相关的。
 &emsp;&emsp;数学语言描述：
 &emsp;&emsp;${H}\_{0}$:${\rho}\_{1}={\rho}\_{2}=...={\rho}\_{m},\forall m\geq1$
 &emsp;&emsp;${H}\_{1}$:至少存在某个${\rho}\_{k}\neq0,\forall m\geq1,k\leq m$
 
  
 	